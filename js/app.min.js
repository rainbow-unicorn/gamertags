/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 */
!function($,window,document,undefined){function Plugin(element,options){this.element=element,this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this.Gamertags=[],this.init()}var pluginName="gamertags",defaults={propertyName:"value",loginModal:$("[data-remodal-id=login]").remodal()};Plugin.prototype={init:function(){this.options.loginModal.open(),$("#gamertags").DataTable({columns:[{data:"gamer"},{data:"gamertag"}]}),this.facebookInit(),this.facebookBindings()},facebookInit:function(){$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"399385496935911",version:"v2.4",xfbml:!0})})},facebookBindings:function(){$(document).on("closing",".remodal",this.facebookLogin)},facebookLogin:function(){FB.login(function(response){function _init(){getFriendCodes()}function getFriendCodes(){FB.api("/561961807201477",function(response){!response||response.error?alert("Something went wrong."):(extractGamertags(response.message),renderList(Gamertags))})}function extractGamertags(message){var html=$.parseHTML(message);$.each(html,function(i,el){if("undefined"!=el.childNodes.length&&el.childNodes.length>=2){for(var props=el.textContent.split(/[.]+/),tag=[],c=0;c<props.length;c++)if(props[c].match(/\d{4}-\d{4}-\d{4}/))tag.gamertag=props[c];else{if(!props[c].match(/[\w()]+/))return!1;tag.gamer=props[c]}Gamertags.push(tag)}})}function renderList(gamertags){for(var i=0;i<gamertags.length;i++)$("#gamertags").DataTable().row.add({gamer:gamertags[i].gamer,gamertag:gamertags[i].gamertag}).draw()}if(response.authResponse){var Gamertags=[];_init()}else console.log("Authorization failed.")},{scope:"public_profile"})}},$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new Plugin(this,options))})}}(jQuery,window,document),$(document).gamertags();